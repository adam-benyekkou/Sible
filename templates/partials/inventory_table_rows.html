{% for host in hosts %}
<tr>
    <td style="font-weight: 600; color: var(--text-primary);">{{ host.alias }}</td>
    <td><code style="font-size: 0.9em;">{{ host.hostname }}</code></td>
    <td>{{ host.ssh_user }}<span class="text-muted">@{{ host.ssh_port }}</span></td>

    <td>
        {% if host.group_name != 'all' %}
        <span class="group-badge">{{ host.group_name }}</span>
        {% else %}
        <span class="group-badge">All</span>
        {% endif %}
    </td>
    <td>
        <div style="display: flex; align-items: center; gap: 8px;">
            {% if host.status == 'online' %}
            <span
                style="width: 8px; height: 8px; background: var(--sible-success); border-radius: 50%; display: inline-block;"></span>
            <span style="font-size: 0.85rem; color: var(--text-secondary);">Online</span>
            {% if host.latency %}
            <span style="font-size: 0.75rem; color: var(--text-muted);">({{ host.latency|round(1) }}ms)</span>
            {% endif %}
            {% elif host.status == 'offline' %}
            <span
                style="width: 8px; height: 8px; background: var(--sible-error); border-radius: 50%; display: inline-block;"></span>
            <span style="font-size: 0.85rem; color: var(--text-secondary);">Offline</span>
            {% else %}
            <span
                style="width: 8px; height: 8px; background: var(--border-subtle); border-radius: 50%; display: inline-block;"></span>
            <span style="font-size: 0.85rem; color: var(--text-muted);">Unknown</span>
            {% endif %}

        </div>
    </td>
    <td style="text-align: right; display: flex; justify-content: flex-end; align-items: center; gap: 4px;">
        <button class="action-btn" title="Toggle Favorite" hx-post="/api/inventory/hosts/{{ host.id }}/favorite"
            hx-swap="none" x-data="{ isFav: {{ 'true' if host.id in fav_ids else 'false' }} }" @click="isFav = !isFav"
            style="padding: 0; outline: none;">
            <i data-lucide="heart"
                :style="'width: 16px; height: 16px; transition: all 0.2s; ' + (isFav ? 'fill: var(--sible-error); color: var(--sible-error);' : 'fill: transparent; color: var(--text-muted);')"
                :class="{ 'heart-active': isFav }"></i>
        </button>
        {% if request.state.user.role in ['admin', 'operator'] %}
        <button class="action-btn" title="Open Terminal" onclick="openTerminal('{{ host.id }}', '{{ host.alias }}')">
            <i data-lucide="terminal" style="width: 14px; height: 14px;"></i>
        </button>
        {% endif %}
        {% if request.state.user.role == 'admin' %}
        <button class="action-btn" title="Edit Host"
            @click="editHost({{ host.id }}, '{{ host.alias }}', '{{ host.hostname }}', '{{ host.ssh_user }}', {{ host.ssh_port }}, '{{ host.group_name }}', '{{ host.ssh_key_path or '' }}', '{{ host.ssh_key_secret or '' }}')">
            <i data-lucide="edit-3" style="width: 14px; height: 14px;"></i>
        </button>
        <button class="action-btn" style="color: var(--sible-error);" title="Delete Host"
            hx-delete="/api/inventory/hosts/{{ host.id }}" hx-confirm="Delete host {{ host.alias }}?">
            <i data-lucide="trash-2" style="width: 14px; height: 14px;"></i>
        </button>
        {% endif %}
    </td>

</tr>
{% endfor %}
{% if not hosts %}
<tr>
    <td colspan="6" style="text-align: center; color: var(--ds-gray-600); padding: 4rem 2rem;">
        <i data-lucide="server-off"
            style="width: 32px; height: 32px; margin-bottom: 1rem; stroke-width: 1.5px; opacity: 0.5;"></i>
        <div style="font-weight: 500; margin-bottom: 0.5rem;">No hosts found</div>
        <div style="font-size: 0.875rem;">Add one to get started.</div>
    </td>
</tr>
{% endif %}

{% if total_pages > 1 %}
<tr>
    <td colspan="6"
        style="padding: 12px; border-top: 1px solid var(--border-subtle); background: var(--surface-secondary);">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <div style="font-size: 12px; color: var(--text-muted); font-weight: 500;">
                Page <span style="color: var(--text-primary);">{{ page }}</span> of {{ total_pages }}
                <span style="color: var(--text-muted); margin-left: 8px; font-weight: 400;">({{ total_count }}
                    hosts)</span>
            </div>
            <div style="display: flex; gap: 8px;">
                <button type="button" {% if has_prev %}
                    hx-get="/api/inventory/hosts?page={{ page - 1 }}{% if search %}&search={{ search }}{% endif %}"
                    hx-target="#inventory-table-body" {% else %} disabled style="opacity: 0.5; cursor: not-allowed;" {%
                    endif %} class="secondary"
                    style="height: 28px; padding: 0 12px; font-size: 12px; border-radius: 6px; border: 1px solid var(--border-subtle); background: var(--surface-primary); color: var(--text-primary); display: flex; align-items: center; gap: 4px;">
                    <i data-lucide="chevron-left" style="width: 12px; height: 12px;"></i> Previous
                </button>

                <button type="button" {% if has_next %}
                    hx-get="/api/inventory/hosts?page={{ page + 1 }}{% if search %}&search={{ search }}{% endif %}"
                    hx-target="#inventory-table-body" {% else %} disabled style="opacity: 0.5; cursor: not-allowed;" {%
                    endif %} class="secondary"
                    style="height: 28px; padding: 0 12px; font-size: 12px; border-radius: 6px; border: 1px solid var(--border-subtle); background: var(--surface-primary); color: var(--text-primary); display: flex; align-items: center; gap: 4px;">
                    Next <i data-lucide="chevron-right" style="width: 12px; height: 12px;"></i>
                </button>
            </div>

        </div>
        <script>
            // Re-initialize icons for new content
            if (typeof lucide !== 'undefined') { lucide.createIcons(); }
        </script>
    </td>
</tr>
{% endif %}