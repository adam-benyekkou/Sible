[allowlist]
    description = "Global allowlist"
    paths = [
        '''app/blueprints/.*'''
    ]

[[rules]]
    description = "Developer Email Leak"
    id = "developer-email"
    regex = '''cavy\.protocol\.dev@proton\.me'''
    keywords = [
        "cavy",
        "proton"
    ]

[[rules]]
    description = "Private Key"
    id = "private-key"
    regex = '''(?i)-----BEGIN[ A-Z0-9]*PRIVATE KEY-----'''
    keywords = [
        "-----BEGIN"
    ]

[[rules]]
    description = "Generic API Key"
    id = "generic-api-key"
    regex = '''(?i)(?:key|api|token|secret|pass|auth)[=:]\s*['"][0-9a-zA-Z]{16,128}['"]'''
    entropy = 3.5
    keywords = [
        "key",
        "api",
        "token",
        "secret",
        "pass",
        "auth"
    ]

[[rules]]
    description = "Ansible Vault Password"
    id = "ansible-vault-password"
    regex = '''(?i)(?:ansible_vault_password|vault_password|ANSIBLE_VAULT_PASSWORD)[=:]\s*['"]['"]?[^\s'"]{8,}['"]?'''
    keywords = [
        "vault_password",
        "ANSIBLE_VAULT_PASSWORD"
    ]

[[rules]]
    description = "Ansible Vault File Content"
    id = "ansible-vault-file"
    regex = '''\$ANSIBLE_VAULT;[0-9]\.[0-9];[A-Z0-9]+'''
    keywords = [
        "$ANSIBLE_VAULT"
    ]

[[rules]]
    description = "SSH Passphrase"
    id = "ssh-passphrase"
    regex = '''(?i)(?:ssh_passphrase|ansible_ssh_pass)[=:]\s*['"][^'"]{6,}['"]'''
    keywords = [
        "ssh_passphrase",
        "ansible_ssh_pass"
    ]

[[rules]]
    description = "Database Connection String"
    id = "database-url"
    regex = '''(?i)(?:database_url|db_url|connection_string)[=:]\s*['"]?(?:postgresql|mysql|mongodb|sqlite)://[^'"\s]+['"]?'''
    keywords = [
        "database_url",
        "postgresql://",
        "mysql://",
        "mongodb://"
    ]

[[rules]]
    description = "JWT Secret Key"
    id = "jwt-secret"
    regex = '''(?i)(?:jwt_secret|secret_key|SECRET_KEY)[=:]\s*['"][a-zA-Z0-9\-_]{32,}['"]'''
    keywords = [
        "jwt_secret",
        "SECRET_KEY"
    ]

[[rules]]
    description = "Fernet Encryption Key"
    id = "fernet-key"
    regex = '''(?i)(?:fernet_key|encryption_key)[=:]\s*['"][A-Za-z0-9+/]{43}=['"]'''
    keywords = [
        "fernet_key",
        "encryption_key"
    ]

[[rules]]
    description = "Docker Hub Credentials"
    id = "docker-credentials"
    regex = '''(?i)(?:docker_password|dockerhub_token)[=:]\s*['"][^'"]{8,}['"]'''
    keywords = [
        "docker_password",
        "dockerhub_token"
    ]

[[rules]]
    description = "Sible Environment Variables"
    id = "sible-env-vars"
    regex = '''(?i)(?:SIBLE_SECRET_KEY|SIBLE_DATABASE_URL|SIBLE_ANSIBLE_VAULT_PASSWORD)[=:]\s*['"]?[^'"\s]{8,}['"]?'''
    keywords = [
        "SIBLE_SECRET_KEY",
        "SIBLE_DATABASE_URL",
        "SIBLE_ANSIBLE_VAULT_PASSWORD"
    ]

[[rules]]
    description = "Environment File Commits"
    id = "env-file"
    regex = '''(?:^|/)\.env(?:\.[a-z]+)?$'''
    path = '''(?:^|/)\.env(?:\.[a-z]+)?$'''
    keywords = [
        ".env"
    ]

[[rules]]
    description = "Bcrypt Password Hash"
    id = "bcrypt-hash"
    regex = '''\$2[aby]\$[0-9]{2}\$[A-Za-z0-9./]{53}'''
    keywords = [
        "$2a$",
        "$2b$",
        "$2y$"
    ]

[[rules]]
    description = "SSH Private Key File"
    id = "ssh-key-file"
    regex = '''(?i)-----BEGIN (?:RSA|DSA|EC|OPENSSH) PRIVATE KEY-----'''
    keywords = [
        "BEGIN RSA PRIVATE KEY",
        "BEGIN DSA PRIVATE KEY",
        "BEGIN EC PRIVATE KEY",
        "BEGIN OPENSSH PRIVATE KEY"
    ]

[[rules]]
    description = "Ansible Become Password"
    id = "ansible-become-pass"
    regex = '''(?i)(?:ansible_become_pass|ansible_become_password)[=:]\s*['"][^'"]{4,}['"]'''
    keywords = [
        "ansible_become_pass",
        "ansible_become_password"
    ]

[[rules]]
    description = "Generic Password in Config"
    id = "generic-password"
    regex = '''(?i)(?:password|passwd|pwd)[=:]\s*['"][^'"\s]{6,}['"]'''
    entropy = 3.0
    keywords = [
        "password",
        "passwd",
        "pwd"
    ]
